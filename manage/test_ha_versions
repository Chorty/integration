
minimum=$(python3 manage/get_minimun_supported_ha_version.py)
current=$(python3 manage/get_newest_ha_version.py)

cp -f /home/runner/work/integration/integration/.devcontainer/sample_configuration.yaml /home/runner/work/integration/integration/configuration.yaml

echo "testing with this configuration:"
cat /home/runner/work/integration/integration/configuration.yaml
echo
echo

for i in $(seq $minimum $current); do
    echo "Testing HACS with Home Assistant Core version 0.$i.0"
    python3 -m pip install homeassistant==0.$i.0
    hass --script check_config --config /home/runner/work/integration/integration
    echo
    echo
done

echo "Testing HACS with latest Home Assistant Core Beta"
python3 -m pip install -U --pre homeassistant
hass --script check_config --config /home/runner/work/integration/integration
echo
echo

echo "Testing HACS with Home Assistant Core Dev"
python3 -m pip install git+git://github.com/home-assistant/home-assistant.git@dev
hass --script check_config --config /home/runner/work/integration/integration
